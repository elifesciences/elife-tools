from collections import OrderedDict

# output from elife02304.xml
expected = [
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.001"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.001"),
            (
                "content",
                "Malate and lactate dehydrogenases (MDH and LDH) are homologous, core metabolic enzymes that share a fold and catalytic mechanism yet possess strict specificity for their substrates. In the Apicomplexa, convergent evolution of an unusual LDH from MDH produced a difference in specificity exceeding 12 orders of magnitude. The mechanisms responsible for this extraordinary functional shift are currently unknown. Using ancestral protein resurrection, we find that specificity evolved in apicomplexan LDHs by classic neofunctionalization characterized by long-range epistasis, a promiscuous intermediate, and few gain-of-function mutations of large effect. In canonical MDHs and LDHs, a single residue in the active-site loop governs substrate specificity: Arg102 in MDHs and Gln102 in LDHs. During the evolution of the apicomplexan LDH, however, specificity switched via an insertion that shifted the position and identity of this ‘specificity residue’ to Trp107f. Residues far from the active site also determine specificity, as shown by the crystal structures of three ancestral proteins bracketing the key duplication event. This work provides an unprecedented atomic-resolution view of evolutionary trajectories creating a nascent enzymatic function. DOI: http://dx.doi.org/10.7554/eLife.02304.001",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "abstract"),
            ("position", 1),
            ("ordinal", 1),
            ("sibling_ordinal", 1),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.002"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.002"),
            ("title", "eLife digest"),
            ("full_title", "eLife digest"),
            (
                "content",
                "How are new genes created? Most of the mutations in the genome of an organism place the organism at some sort of disadvantage, but a small number confer an advantage. The beneficial changes are usually retained by subsequent generations and can ultimately lead to the creation of new genes. An example is the gene that encodes an enzyme called lactate dehydrogenase (LDH). This enzyme is involved in anaerobic respiration, the process that allows organisms to produce energy without using oxygen. The LDH enzyme is found in many species of animals and parasites, including those that spread malaria and other diseases. However, there are important differences in the structures of the LDH enzyme in animals and some parasites, like the malarial Plasmodium, because the genes for the enzymes in these two groups evolved separately. The parasite version of the LDH enzyme evolved hundreds of millions of years ago from an enzyme with a similar structure called malate dehydrogenase, which was inherited from bacteria. To work out how the LDH enzyme developed, Boucher et al. predicted and built the ancestral proteins that would have formed as the bacterial enzyme evolved into LDH. Studying these structures revealed that two mutations were mainly responsible for this evolution: six amino acids were added to the active site of the enzyme, and one amino acid (at position 102) was replaced by a different amino acid. However, introducing the same mutations into a modern version of the bacterial enzyme did not produce a working form of the LDH enzyme. This suggests that other amino acids, further away from the active site, also influenced how LDH evolved. The structures found by Boucher et al. reveal that the enzymes evolved as a result of a gene duplicating, followed by one of the copies evolving a new function. However, some of the mutations responsible for the novel function occurred far from the active site, and it is still unknown how they exert their functional effects. Untangling the important mutations from the mundane will be necessary to fully understand how protein functions are created and how to control them—both of which will aid in developing effective drugs that target essential parasite proteins. DOI: http://dx.doi.org/10.7554/eLife.02304.002",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "abstract"),
            ("position", 2),
            ("ordinal", 2),
            ("sibling_ordinal", 2),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.003"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.003"),
            ("id", "fig1"),
            (
                "title",
                "Schematic of M/LDH superfamily active site and catalytic mechanism.",
            ),
            (
                "full_title",
                "Schematic of M/LDH superfamily active site and catalytic mechanism.",
            ),
            ("label", "Figure 1."),
            ("full_label", "Figure 1."),
            (
                "caption",
                "MDH reduces oxaloacetate to malate, in which the R-group is a methylene carboxylate group. LDH reduces pyruvate to lactate, in which the R-group is a methyl group. Key conserved active site residues are shown in black; substrate is shown in blue. The oxidized 2-ketoacid form of the substrate is at left; the reduced 2-hydroxy acid form is shown at right. The R-group of the substrate interacts with Arg102 in MDHs and Gln102 in canonical LDHs. Both Arg109 and position 102 are found in the mobile ‘specificity loop’ that closes over the active site.",
            ),
            (
                "full_caption",
                "MDH reduces oxaloacetate to malate, in which the R-group is a methylene carboxylate group. LDH reduces pyruvate to lactate, in which the R-group is a methyl group. Key conserved active site residues are shown in black; substrate is shown in blue. The oxidized 2-ketoacid form of the substrate is at left; the reduced 2-hydroxy acid form is shown at right. The R-group of the substrate interacts with Arg102 in MDHs and Gln102 in canonical LDHs. Both Arg109 and position 102 are found in the mobile ‘specificity loop’ that closes over the active site.",
            ),
            (
                "content",
                "MDH reduces oxaloacetate to malate, in which the R-group is a methylene carboxylate group. LDH reduces pyruvate to lactate, in which the R-group is a methyl group. Key conserved active site residues are shown in black; substrate is shown in blue. The oxidized 2-ketoacid form of the substrate is at left; the reduced 2-hydroxy acid form is shown at right. The R-group of the substrate interacts with Arg102 in MDHs and Gln102 in canonical LDHs. Both Arg109 and position 102 are found in the mobile ‘specificity loop’ that closes over the active site. DOI: http://dx.doi.org/10.7554/eLife.02304.003",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 3),
            ("ordinal", 1),
            ("sibling_ordinal", 1),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.004"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.004"),
            ("id", "fig1s1"),
            ("title", "Fold architecture in the LDH and MDH superfamily."),
            ("full_title", "Fold architecture in the LDH and MDH superfamily."),
            ("label", "Figure 1—figure supplement 1."),
            ("full_label", "Figure 1—figure supplement 1."),
            (
                "caption",
                "At left is CpMDH (blue, 2hjr), at right is PfLDH (vermilion and olive, 1t2d). The Rossmann fold domain, which binds the NADH cofactor, is show as light blue in CpMDH and vermilion in PfLDH. The active site is found at the interface of the two domains. In CpMDH, the ‘opposing loop’ is highlighted in yellow (see text). In PfLDH, the six-residue insertion is highlighted in yellow.",
            ),
            (
                "full_caption",
                "At left is <italic>Cp</italic>MDH (blue, 2hjr), at right is <italic>Pf</italic>LDH (vermilion and olive, 1t2d). The Rossmann fold domain, which binds the NADH cofactor, is show as light blue in <italic>Cp</italic>MDH and vermilion in <italic>Pf</italic>LDH. The active site is found at the interface of the two domains. In <italic>Cp</italic>MDH, the ‘opposing loop’ is highlighted in yellow (see text). In <italic>Pf</italic>LDH, the six-residue insertion is highlighted in yellow.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 1),
            ("parent_sibling_ordinal", 1),
            ("parent_asset", None),
            (
                "content",
                "At left is CpMDH (blue, 2hjr), at right is PfLDH (vermilion and olive, 1t2d). The Rossmann fold domain, which binds the NADH cofactor, is show as light blue in CpMDH and vermilion in PfLDH. The active site is found at the interface of the two domains. In CpMDH, the ‘opposing loop’ is highlighted in yellow (see text). In PfLDH, the six-residue insertion is highlighted in yellow. DOI: http://dx.doi.org/10.7554/eLife.02304.004",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 4),
            ("ordinal", 2),
            ("sibling_ordinal", 2),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.005"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.005"),
            ("id", "fig2"),
            ("title", "Apicomplexan M/LDH active sites."),
            ("full_title", "Apicomplexan M/LDH active sites."),
            ("label", "Figure 2."),
            ("full_label", "Figure 2."),
            (
                "caption",
                "Structures of CpMDH (blue, 2hjr) and PfLDH (vermilion, 1t2d) superposed using THESEUS. The ligands (oxalate and NAD+) are from 1t2d and colored white. Side chains of important residues are shown as sticks and the six-residue insert of PfLDH is highlighted in yellow. Note how the PfLDH Trp107f overlays Arg102 from CpMDH. Residues in the insertion are labeled using numbers and letters to maintain consistency with homologous positions in the dogfish LDH.",
            ),
            (
                "full_caption",
                "Structures of <italic>Cp</italic>MDH (blue, 2hjr) and <italic>Pf</italic>LDH (vermilion, 1t2d) superposed using THESEUS. The ligands (oxalate and NAD<sup>+</sup>) are from 1t2d and colored white. Side chains of important residues are shown as sticks and the six-residue insert of <italic>Pf</italic>LDH is highlighted in yellow. Note how the <italic>Pf</italic>LDH Trp107f overlays Arg102 from <italic>Cp</italic>MDH. Residues in the insertion are labeled using numbers and letters to maintain consistency with homologous positions in the dogfish LDH.",
            ),
            (
                "content",
                "Structures of CpMDH (blue, 2hjr) and PfLDH (vermilion, 1t2d) superposed using THESEUS. The ligands (oxalate and NAD+) are from 1t2d and colored white. Side chains of important residues are shown as sticks and the six-residue insert of PfLDH is highlighted in yellow. Note how the PfLDH Trp107f overlays Arg102 from CpMDH. Residues in the insertion are labeled using numbers and letters to maintain consistency with homologous positions in the dogfish LDH. DOI: http://dx.doi.org/10.7554/eLife.02304.005",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 5),
            ("ordinal", 3),
            ("sibling_ordinal", 2),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.006"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.006"),
            ("id", "fig2s1"),
            (
                "title",
                "Sequence alignment of the specificity loop from apicomplexan M/LDHs with ancestral sequences.",
            ),
            (
                "full_title",
                "Sequence alignment of the specificity loop from apicomplexan M/LDHs with ancestral sequences.",
            ),
            ("label", "Figure 2—figure supplement 1."),
            ("full_label", "Figure 2—figure supplement 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 3),
            ("parent_sibling_ordinal", 2),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.006"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 6),
            ("ordinal", 4),
            ("sibling_ordinal", 2),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.007"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.007"),
            ("id", "fig2s2"),
            ("title", "Alanine scanning of PfLDH specificity loop."),
            (
                "full_title",
                "Alanine scanning of <italic>Pf</italic>LDH specificity loop.",
            ),
            ("label", "Figure 2—figure supplement 2."),
            ("full_label", "Figure 2—figure supplement 2."),
            (
                "caption",
                "Logarithm of pyruvate kcat/KM of PfLDH and each mutant. Labels on x-axis describe the mutation tested in the WT PfLDH background.",
            ),
            (
                "full_caption",
                "Logarithm of pyruvate k<sub>cat</sub>/K<sub>M</sub> of <italic>Pf</italic>LDH and each mutant. Labels on x-axis describe the mutation tested in the WT <italic>Pf</italic>LDH background.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 3),
            ("parent_sibling_ordinal", 2),
            ("parent_asset", None),
            (
                "content",
                "Logarithm of pyruvate kcat/KM of PfLDH and each mutant. Labels on x-axis describe the mutation tested in the WT PfLDH background. DOI: http://dx.doi.org/10.7554/eLife.02304.007 10.7554/eLife.02304.008Figure 2—figure supplement 2—source data 1.Kinetic parameters for PfLDH alanine-scan.DOI: http://dx.doi.org/10.7554/eLife.02304.008 DOI: http://dx.doi.org/10.7554/eLife.02304.008",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 7),
            ("ordinal", 5),
            ("sibling_ordinal", 3),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.008"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.008"),
            ("id", "SD1-data"),
            ("title", "Kinetic parameters for PfLDH alanine-scan."),
            ("full_title", "Kinetic parameters for PfLDH alanine-scan."),
            ("label", "Figure 2—figure supplement 2—source data 1."),
            ("full_label", "Figure 2—figure supplement 2—source data 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 5),
            ("parent_sibling_ordinal", 3),
            ("parent_asset", "figsupp"),
            ("parent_parent_type", "fig"),
            ("parent_parent_ordinal", 3),
            ("parent_parent_sibling_ordinal", 2),
            ("parent_parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.008"),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 8),
            ("ordinal", 1),
            ("sibling_ordinal", 1),
            ("asset", "data"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.009"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.009"),
            ("id", "fig2s3"),
            ("title", "Crystal structure of PfLDH-W107fA mutant."),
            (
                "full_title",
                "Crystal structure of <italic>Pf</italic>LDH-W107fA mutant.",
            ),
            ("label", "Figure 2—figure supplement 3."),
            ("full_label", "Figure 2—figure supplement 3."),
            (
                "caption",
                "(A) Crystal lattice of the W107fA mutant (left) compared to the WT PfLDH (right). (B) Superposition of the WT PfLDH (olive) and the W107fA mutant (vermilion). The structures are highly similar throughout, expect for the active site loop (at top), which is closed in the WT and partially disordered and open in the mutant.",
            ),
            (
                "full_caption",
                "(<bold>A</bold>) Crystal lattice of the W107fA mutant (left) compared to the WT <italic>Pf</italic>LDH (right). (<bold>B</bold>) Superposition of the WT <italic>Pf</italic>LDH (olive) and the W107fA mutant (vermilion). The structures are highly similar throughout, expect for the active site loop (at top), which is closed in the WT and partially disordered and open in the mutant.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 3),
            ("parent_sibling_ordinal", 2),
            ("parent_asset", None),
            (
                "content",
                "(A) Crystal lattice of the W107fA mutant (left) compared to the WT PfLDH (right). (B) Superposition of the WT PfLDH (olive) and the W107fA mutant (vermilion). The structures are highly similar throughout, expect for the active site loop (at top), which is closed in the WT and partially disordered and open in the mutant. DOI: http://dx.doi.org/10.7554/eLife.02304.009",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 9),
            ("ordinal", 6),
            ("sibling_ordinal", 4),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.010"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.010"),
            ("id", "fig3"),
            ("title", "Phylogeny of apicomplexan M/LDH superfamily."),
            ("full_title", "Phylogeny of apicomplexan M/LDH superfamily."),
            ("label", "Figure 3."),
            ("full_label", "Figure 3."),
            (
                "caption",
                "(A) 1844 taxa. The tree is colored according to function (LDH—vermilion; MDH—blue; HicDH—moss). The N-terminal Rossmann-fold of glucosidases and aspartate dehydrogenases (AspDHs) was used to root the phylogeny. Numbers highlight convergent events of LDH evolution from MDHs: 1–Canonical LDHs, 2–Trichomonad LDHs, and 3,4–apicomplexan LDHs. The shaded clades have highly significant supports (Anisimova and Gascuel, 2006). (B) Apicomplexan M/LDH Clade. A close-up of the apicomplexan portion of the phylogeny in A, similarly colored by function. aLRT supports for each group: α-proteobacteria MDHs, 15; apicomplexan LDHs, 11; Plasmodium LDHs, 333; Cryptosporidium MDHs, 54; Cryptosporidium LDHs, 202. Ancestral reconstructed proteins are labeled at internal nodes (AncMDH1, AncMDH2, AncMDH3, AncLDH). The focus of the present work is the gene duplication at node 3.",
            ),
            (
                "full_caption",
                '(<bold>A</bold>) 1844 taxa. The tree is colored according to function (LDH—vermilion; MDH—blue; HicDH—moss). The N-terminal Rossmann-fold of glucosidases and aspartate dehydrogenases (AspDHs) was used to root the phylogeny. Numbers highlight convergent events of LDH evolution from MDHs: 1–Canonical LDHs, 2–Trichomonad LDHs, and 3,4–apicomplexan LDHs. The shaded clades have highly significant supports (<xref ref-type="bibr" rid="bib3">Anisimova and Gascuel, 2006</xref>). (<bold>B</bold>) Apicomplexan M/LDH Clade. A close-up of the apicomplexan portion of the phylogeny in <bold>A</bold>, similarly colored by function. aLRT supports for each group: α-proteobacteria MDHs, 15; apicomplexan LDHs, 11; <italic>Plasmodium</italic> LDHs, 333; <italic>Cryptosporidium</italic> MDHs, 54; <italic>Cryptosporidium</italic> LDHs, 202. Ancestral reconstructed proteins are labeled at internal nodes (AncMDH1, AncMDH2, AncMDH3, AncLDH). The focus of the present work is the gene duplication at node 3.',
            ),
            (
                "content",
                "(A) 1844 taxa. The tree is colored according to function (LDH—vermilion; MDH—blue; HicDH—moss). The N-terminal Rossmann-fold of glucosidases and aspartate dehydrogenases (AspDHs) was used to root the phylogeny. Numbers highlight convergent events of LDH evolution from MDHs: 1–Canonical LDHs, 2–Trichomonad LDHs, and 3,4–apicomplexan LDHs. The shaded clades have highly significant supports (Anisimova and Gascuel, 2006). (B) Apicomplexan M/LDH Clade. A close-up of the apicomplexan portion of the phylogeny in A, similarly colored by function. aLRT supports for each group: α-proteobacteria MDHs, 15; apicomplexan LDHs, 11; Plasmodium LDHs, 333; Cryptosporidium MDHs, 54; Cryptosporidium LDHs, 202. Ancestral reconstructed proteins are labeled at internal nodes (AncMDH1, AncMDH2, AncMDH3, AncLDH). The focus of the present work is the gene duplication at node 3. DOI: http://dx.doi.org/10.7554/eLife.02304.010",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 10),
            ("ordinal", 7),
            ("sibling_ordinal", 3),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.011"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.011"),
            ("id", "fig3s1"),
            ("title", "Phylogeny of M/LDH superfamily."),
            ("full_title", "Phylogeny of M/LDH superfamily."),
            ("label", "Figure 3—figure supplement 1."),
            ("full_label", "Figure 3—figure supplement 1."),
            (
                "caption",
                "Same phylogeny as Figure 3A with select branch supports shown (aLRT supports).",
            ),
            (
                "full_caption",
                'Same phylogeny as <xref ref-type="fig" rid="fig3">Figure 3A</xref> with select branch supports shown (aLRT supports).',
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 7),
            ("parent_sibling_ordinal", 3),
            ("parent_asset", None),
            (
                "content",
                "Same phylogeny as Figure 3A with select branch supports shown (aLRT supports). DOI: http://dx.doi.org/10.7554/eLife.02304.011",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 11),
            ("ordinal", 8),
            ("sibling_ordinal", 2),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.012"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.012"),
            ("id", "fig3s2"),
            ("title", "Phylogeny of M/LDH superfamily."),
            ("full_title", "Phylogeny of M/LDH superfamily."),
            ("label", "Figure 3—figure supplement 2."),
            ("full_label", "Figure 3—figure supplement 2."),
            (
                "caption",
                "Same phylogeny as Figure 3A. The tree is colored by domain of life (eubacterial—vermilion; eukaryotic—blue; archeal—magenta).",
            ),
            (
                "full_caption",
                'Same phylogeny as <xref ref-type="fig" rid="fig3">Figure 3A</xref>. The tree is colored by domain of life (eubacterial—vermilion; eukaryotic—blue; archeal—magenta).',
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 7),
            ("parent_sibling_ordinal", 3),
            ("parent_asset", None),
            (
                "content",
                "Same phylogeny as Figure 3A. The tree is colored by domain of life (eubacterial—vermilion; eukaryotic—blue; archeal—magenta). DOI: http://dx.doi.org/10.7554/eLife.02304.012",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 12),
            ("ordinal", 9),
            ("sibling_ordinal", 3),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.013"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.013"),
            ("id", "fig3s3"),
            ("title", "Apicomplexan M/LDH Clade."),
            ("full_title", "Apicomplexan M/LDH Clade."),
            ("label", "Figure 3—figure supplement 3."),
            ("full_label", "Figure 3—figure supplement 3."),
            (
                "caption",
                "Same phylogeny as Figure 3B with aLRT branch supports and clades shown in full detail.",
            ),
            (
                "full_caption",
                'Same phylogeny as <xref ref-type="fig" rid="fig3">Figure 3B</xref> with aLRT branch supports and clades shown in full detail.',
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 7),
            ("parent_sibling_ordinal", 3),
            ("parent_asset", None),
            (
                "content",
                "Same phylogeny as Figure 3B with aLRT branch supports and clades shown in full detail. DOI: http://dx.doi.org/10.7554/eLife.02304.013",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 13),
            ("ordinal", 10),
            ("sibling_ordinal", 4),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.014"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.014"),
            ("id", "fig4"),
            ("title", "Specificity switching in apicomplexan M/LDHs."),
            ("full_title", "Specificity switching in apicomplexan M/LDHs."),
            ("label", "Figure 4."),
            ("full_label", "Figure 4."),
            (
                "caption",
                "Blue horizontal bars (left) quantify activity towards oxaloacetate; vermilion horizontal bars (right) quantify activity towards pyruvate. Activity is measured as log10(kcat/KM ), where kcat/KM is in units of s-1M−1. Error bars are shown as small black brackets and represent 1 SD of the mean from triplicate measurements. INS refers to the presence of the six-residue insertion from PfLDH, DEL refers to the removal of the six-residue insertion. Relative specificity (RS) is the ratio of kcat/KM for pyruvate vs oxaloacetate, with positive log10(RS) representing a preference for pyruvate and negative log10(RS) representing a preference for oxaloacetate. All logarithms are base 10.",
            ),
            (
                "full_caption",
                "Blue horizontal bars (left) quantify activity towards oxaloacetate; vermilion horizontal bars (right) quantify activity towards pyruvate. Activity is measured as log<sub>10</sub>(k<sub>cat</sub>/K<sub>M</sub> ), where k<sub>cat</sub>/K<sub>M</sub> is in units of s<sup>-1</sup>M<sup>−1</sup>. Error bars are shown as small black brackets and represent 1 SD of the mean from triplicate measurements. INS refers to the presence of the six-residue insertion from <italic>Pf</italic>LDH, DEL refers to the removal of the six-residue insertion. Relative specificity (RS) is the ratio of k<sub>cat</sub>/K<sub>M</sub> for pyruvate vs oxaloacetate, with positive log<sub>10</sub>(RS) representing a preference for pyruvate and negative log<sub>10</sub>(RS) representing a preference for oxaloacetate. All logarithms are base 10.",
            ),
            (
                "content",
                "Blue horizontal bars (left) quantify activity towards oxaloacetate; vermilion horizontal bars (right) quantify activity towards pyruvate. Activity is measured as log10(kcat/KM ), where kcat/KM is in units of s-1M−1. Error bars are shown as small black brackets and represent 1 SD of the mean from triplicate measurements. INS refers to the presence of the six-residue insertion from PfLDH, DEL refers to the removal of the six-residue insertion. Relative specificity (RS) is the ratio of kcat/KM for pyruvate vs oxaloacetate, with positive log10(RS) representing a preference for pyruvate and negative log10(RS) representing a preference for oxaloacetate. All logarithms are base 10. DOI: http://dx.doi.org/10.7554/eLife.02304.014 10.7554/eLife.02304.015Figure 4—source data 1.Kinetic parameters for modern constructs.DOI: http://dx.doi.org/10.7554/eLife.02304.015 DOI: http://dx.doi.org/10.7554/eLife.02304.015",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 14),
            ("ordinal", 11),
            ("sibling_ordinal", 4),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.015"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.015"),
            ("id", "SD2-data"),
            ("title", "Kinetic parameters for modern constructs."),
            ("full_title", "Kinetic parameters for modern constructs."),
            ("label", "Figure 4—source data 1."),
            ("full_label", "Figure 4—source data 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 11),
            ("parent_sibling_ordinal", 4),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.015"),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 15),
            ("ordinal", 2),
            ("sibling_ordinal", 1),
            ("asset", "data"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.016"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.016"),
            ("id", "fig5"),
            ("title", "Evolution of novel LDHs in Apicomplexa."),
            ("full_title", "Evolution of novel LDHs in Apicomplexa."),
            ("label", "Figure 5."),
            ("full_label", "Figure 5."),
            (
                "caption",
                "The activities of ancestral and modern apicomplexan M/LDHs are plotted on the corresponding nodes of the protein phylogeny. Nodes are numbered as in Figure 3B. The y-axis of the bar graphs is log(kcat/KM), with oxaloacetate in blue and pyruvate in vermilion. RbMDH is a representative α-proteobacterial MDH from Rickettsia bellii. T. gondii has two LDH proteins (TgLDH1 and TgLDH2), each expressed at different stages of the life cycle (Dando et al., 2001).",
            ),
            (
                "full_caption",
                'The activities of ancestral and modern apicomplexan M/LDHs are plotted on the corresponding nodes of the protein phylogeny. Nodes are numbered as in <xref ref-type="fig" rid="fig3">Figure 3B</xref>. The y-axis of the bar graphs is log(k<sub>cat</sub>/K<sub>M</sub>), with oxaloacetate in blue and pyruvate in vermilion. <italic>Rb</italic>MDH is a representative α-proteobacterial MDH from <italic>Rickettsia bellii</italic>. <italic>T. gondii</italic> has two LDH proteins (TgLDH1 and TgLDH2), each expressed at different stages of the life cycle (<xref ref-type="bibr" rid="bib24">Dando et al., 2001</xref>).',
            ),
            (
                "content",
                "The activities of ancestral and modern apicomplexan M/LDHs are plotted on the corresponding nodes of the protein phylogeny. Nodes are numbered as in Figure 3B. The y-axis of the bar graphs is log(kcat/KM), with oxaloacetate in blue and pyruvate in vermilion. RbMDH is a representative α-proteobacterial MDH from Rickettsia bellii. T. gondii has two LDH proteins (TgLDH1 and TgLDH2), each expressed at different stages of the life cycle (Dando et al., 2001). DOI: http://dx.doi.org/10.7554/eLife.02304.016 10.7554/eLife.02304.017Figure 5—source data 1.Kinetic parameters for ancestral/modern phylogeny.DOI: http://dx.doi.org/10.7554/eLife.02304.017 DOI: http://dx.doi.org/10.7554/eLife.02304.017",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 16),
            ("ordinal", 12),
            ("sibling_ordinal", 5),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.017"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.017"),
            ("id", "SD3-data"),
            ("title", "Kinetic parameters for ancestral/modern phylogeny."),
            ("full_title", "Kinetic parameters for ancestral/modern phylogeny."),
            ("label", "Figure 5—source data 1."),
            ("full_label", "Figure 5—source data 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 12),
            ("parent_sibling_ordinal", 5),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.017"),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 17),
            ("ordinal", 3),
            ("sibling_ordinal", 1),
            ("asset", "data"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.018"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.018"),
            ("id", "fig5s1"),
            ("title", "Sequence identity of ancestral and modern proteins."),
            ("full_title", "Sequence identity of ancestral and modern proteins."),
            ("label", "Figure 5—figure supplement 1."),
            ("full_label", "Figure 5—figure supplement 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 12),
            ("parent_sibling_ordinal", 5),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.018"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 18),
            ("ordinal", 13),
            ("sibling_ordinal", 2),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.019"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.019"),
            ("id", "fig6"),
            ("title", "Specificity switching in ancestral MDH2."),
            ("full_title", "Specificity switching in ancestral MDH2."),
            ("label", "Figure 6."),
            ("full_label", "Figure 6."),
            (
                "caption",
                "INS refers to the reconstructed six-residue insertion from AncLDH. 59Mut is described in the text. Relative specificity (RS) is described in legend of Figure 4.",
            ),
            (
                "full_caption",
                'INS refers to the reconstructed six-residue insertion from AncLDH. 59Mut is described in the text. Relative specificity (RS) is described in legend of <xref ref-type="fig" rid="fig4">Figure 4</xref>.',
            ),
            (
                "content",
                "INS refers to the reconstructed six-residue insertion from AncLDH. 59Mut is described in the text. Relative specificity (RS) is described in legend of Figure 4. DOI: http://dx.doi.org/10.7554/eLife.02304.019 10.7554/eLife.02304.020Figure 6—source data 1.Kinetic parameters for ancestral specificity switch mutants.DOI: http://dx.doi.org/10.7554/eLife.02304.020 DOI: http://dx.doi.org/10.7554/eLife.02304.020 10.7554/eLife.02304.021Figure 6—source data 2.Source data for figure supplement 7. Kinetic parameters for alternative ancestral proteins.DOI: http://dx.doi.org/10.7554/eLife.02304.021 DOI: http://dx.doi.org/10.7554/eLife.02304.021",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 19),
            ("ordinal", 14),
            ("sibling_ordinal", 6),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.020"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.020"),
            ("id", "SD4-data"),
            ("title", "Kinetic parameters for ancestral specificity switch mutants."),
            (
                "full_title",
                "Kinetic parameters for ancestral specificity switch mutants.",
            ),
            ("label", "Figure 6—source data 1."),
            ("full_label", "Figure 6—source data 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.020"),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 20),
            ("ordinal", 4),
            ("sibling_ordinal", 1),
            ("asset", "data"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.021"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.021"),
            ("id", "SD5-data"),
            (
                "title",
                "Source data for figure supplement 7. Kinetic parameters for alternative ancestral proteins.",
            ),
            (
                "full_title",
                "Source data for figure supplement 7. Kinetic parameters for alternative ancestral proteins.",
            ),
            ("label", "Figure 6—source data 2."),
            ("full_label", "Figure 6—source data 2."),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.021"),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 21),
            ("ordinal", 5),
            ("sibling_ordinal", 2),
            ("asset", "data"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.022"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.022"),
            ("id", "fig6s1"),
            ("title", "Histogram of ancestral reconstructions."),
            ("full_title", "Histogram of ancestral reconstructions."),
            ("label", "Figure 6—figure supplement 1."),
            ("full_label", "Figure 6—figure supplement 1."),
            (
                "caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            (
                "full_caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue. DOI: http://dx.doi.org/10.7554/eLife.02304.022",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 22),
            ("ordinal", 15),
            ("sibling_ordinal", 2),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.023"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.023"),
            ("id", "fig6s2"),
            ("title", "Histogram of ancestral reconstructions."),
            ("full_title", "Histogram of ancestral reconstructions."),
            ("label", "Figure 6—figure supplement 2."),
            ("full_label", "Figure 6—figure supplement 2."),
            (
                "caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            (
                "full_caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue. DOI: http://dx.doi.org/10.7554/eLife.02304.023",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 23),
            ("ordinal", 16),
            ("sibling_ordinal", 3),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.024"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.024"),
            ("id", "fig6s3"),
            ("title", "Histogram of ancestral reconstructions."),
            ("full_title", "Histogram of ancestral reconstructions."),
            ("label", "Figure 6—figure supplement 3."),
            ("full_label", "Figure 6—figure supplement 3."),
            (
                "caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            (
                "full_caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue. DOI: http://dx.doi.org/10.7554/eLife.02304.024",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 24),
            ("ordinal", 17),
            ("sibling_ordinal", 4),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.025"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.025"),
            ("id", "fig6s4"),
            ("title", "Histogram of ancestral reconstructions."),
            ("full_title", "Histogram of ancestral reconstructions."),
            ("label", "Figure 6—figure supplement 4."),
            ("full_label", "Figure 6—figure supplement 4."),
            (
                "caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            (
                "full_caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue. DOI: http://dx.doi.org/10.7554/eLife.02304.025",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 25),
            ("ordinal", 18),
            ("sibling_ordinal", 5),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.026"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.026"),
            ("id", "fig6s5"),
            ("title", "Histogram of ancestral reconstructions."),
            ("full_title", "Histogram of ancestral reconstructions."),
            ("label", "Figure 6—figure supplement 5."),
            ("full_label", "Figure 6—figure supplement 5."),
            (
                "caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            (
                "full_caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue. DOI: http://dx.doi.org/10.7554/eLife.02304.026",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 26),
            ("ordinal", 19),
            ("sibling_ordinal", 6),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.027"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.027"),
            ("id", "fig6s6"),
            ("title", "Histogram of ancestral reconstructions."),
            ("full_title", "Histogram of ancestral reconstructions."),
            ("label", "Figure 6—figure supplement 6."),
            ("full_label", "Figure 6—figure supplement 6."),
            (
                "caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            (
                "full_caption",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue.",
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "Reconstructed residues binned according to posterior probability (PP) of the predicted residue. DOI: http://dx.doi.org/10.7554/eLife.02304.027",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 27),
            ("ordinal", 20),
            ("sibling_ordinal", 7),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.028"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.028"),
            ("id", "fig6s7"),
            ("title", "Alternative ancestral enzymes."),
            ("full_title", "Alternative ancestral enzymes."),
            ("label", "Figure 6—figure supplement 7."),
            ("full_label", "Figure 6—figure supplement 7."),
            (
                "caption",
                "INS refers to the reconstructed six amino acid insertion from AncLDH*. 58Mut refers to remaining residue differences between AncMDH* and AncLDH* that are not R102K or INS. Relative specificity (RS) is described in legend of Figure 4.",
            ),
            (
                "full_caption",
                'INS refers to the reconstructed six amino acid insertion from AncLDH*. 58Mut refers to remaining residue differences between AncMDH* and AncLDH* that are not R102K or INS. Relative specificity (RS) is described in legend of <xref ref-type="fig" rid="fig4">Figure 4</xref>.',
            ),
            ("parent_type", "fig"),
            ("parent_ordinal", 14),
            ("parent_sibling_ordinal", 6),
            ("parent_asset", None),
            (
                "content",
                "INS refers to the reconstructed six amino acid insertion from AncLDH*. 58Mut refers to remaining residue differences between AncMDH* and AncLDH* that are not R102K or INS. Relative specificity (RS) is described in legend of Figure 4. DOI: http://dx.doi.org/10.7554/eLife.02304.028",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 28),
            ("ordinal", 21),
            ("sibling_ordinal", 8),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.029"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.029"),
            ("id", "fig7"),
            ("title", "Ancestral and modern dehydrogenase structures."),
            ("full_title", "Ancestral and modern dehydrogenase structures."),
            ("label", "Figure 7."),
            ("full_label", "Figure 7."),
            (
                "caption",
                "(A) Superposition of CpMDH and AncMDH2. Superposition of AncMDH2 structure (blue, 4plw, chain C) and CpMDH (aquamarine, 2hjr, chain A). Ligands from AncMDH2 are shown in gray; ligands from CpMDH are in white. (B) Active site detail of Cp MDH and AncMDH2. Side chains of catalytic residues highlighted as sticks. (C) Superposition of apicomplexan LDHs and AncLDH*. Superposition of AncLDH* structure (vermilion, 4plg, chain A) and four apicomplexan LDHs (deep olive, PfLDH, 1t2d, chain A, Plasmodium berghei (Pb) LDH, 1oc4, chain B, TgLDH1, 1pzh, chain A, TgLDH2, 1sow, chain B). Ligands from AncLDH* are shown in gray, ligands from apicomplexan LDHs are in white. The ‘opposing loop’ and residues 236 and 246 (discussed in text) are highlighted in cyan. (D) Active site detail of apicomplexan LDHs and AncLDH*. Side chains of catalytic residues highlighted as sticks. (E) Superposition of ancestral dehydrogenases. Superposition of AncMDH2 (blue, 4plw, chain C), AncLDH* (vermilion, 4plg, chain A), and AncMDH2-INS (magenta, 4ply, chain F and 4plv, chain B). Ligands are shown in gray. (F) Active site detail of ancestral dehydrogenases. Side chains of catalytic residues highlighted as sticks.",
            ),
            (
                "full_caption",
                "(<bold>A</bold>) Superposition of <italic>Cp</italic>MDH and AncMDH2. Superposition of AncMDH2 structure (blue, 4plw, chain C) and <italic>Cp</italic>MDH (aquamarine, 2hjr, chain A). Ligands from AncMDH2 are shown in gray; ligands from <italic>Cp</italic>MDH are in white. (<bold>B</bold>) Active site detail of <italic>Cp</italic> MDH and AncMDH2. Side chains of catalytic residues highlighted as sticks. (<bold>C</bold>) Superposition of apicomplexan LDHs and AncLDH*. Superposition of AncLDH* structure (vermilion, 4plg, chain A) and four apicomplexan LDHs (deep olive, <italic>Pf</italic>LDH, 1t2d, chain A, <italic>Plasmodium berghei</italic> (<italic>Pb</italic>) LDH, 1oc4, chain B, <italic>Tg</italic>LDH1, 1pzh, chain A, <italic>Tg</italic>LDH2, 1sow, chain B). Ligands from AncLDH* are shown in gray, ligands from apicomplexan LDHs are in white. The ‘opposing loop’ and residues 236 and 246 (discussed in text) are highlighted in cyan. (<bold>D</bold>) Active site detail of apicomplexan LDHs and AncLDH*. Side chains of catalytic residues highlighted as sticks. (<bold>E</bold>) Superposition of ancestral dehydrogenases. Superposition of AncMDH2 (blue, 4plw, chain C), AncLDH* (vermilion, 4plg, chain A), and AncMDH2-INS (magenta, 4ply, chain F and 4plv, chain B). Ligands are shown in gray. (<bold>F</bold>) Active site detail of ancestral dehydrogenases. Side chains of catalytic residues highlighted as sticks.",
            ),
            (
                "content",
                "(A) Superposition of CpMDH and AncMDH2. Superposition of AncMDH2 structure (blue, 4plw, chain C) and CpMDH (aquamarine, 2hjr, chain A). Ligands from AncMDH2 are shown in gray; ligands from CpMDH are in white. (B) Active site detail of Cp MDH and AncMDH2. Side chains of catalytic residues highlighted as sticks. (C) Superposition of apicomplexan LDHs and AncLDH*. Superposition of AncLDH* structure (vermilion, 4plg, chain A) and four apicomplexan LDHs (deep olive, PfLDH, 1t2d, chain A, Plasmodium berghei (Pb) LDH, 1oc4, chain B, TgLDH1, 1pzh, chain A, TgLDH2, 1sow, chain B). Ligands from AncLDH* are shown in gray, ligands from apicomplexan LDHs are in white. The ‘opposing loop’ and residues 236 and 246 (discussed in text) are highlighted in cyan. (D) Active site detail of apicomplexan LDHs and AncLDH*. Side chains of catalytic residues highlighted as sticks. (E) Superposition of ancestral dehydrogenases. Superposition of AncMDH2 (blue, 4plw, chain C), AncLDH* (vermilion, 4plg, chain A), and AncMDH2-INS (magenta, 4ply, chain F and 4plv, chain B). Ligands are shown in gray. (F) Active site detail of ancestral dehydrogenases. Side chains of catalytic residues highlighted as sticks. DOI: http://dx.doi.org/10.7554/eLife.02304.029",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 29),
            ("ordinal", 22),
            ("sibling_ordinal", 7),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.030"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.030"),
            ("id", "fig7s1"),
            (
                "title",
                "Crystallographic statistics table for AncLDH*, AncMDH2, AncMDH2-INS, and PfLDH-W107fA structures.",
            ),
            (
                "full_title",
                "Crystallographic statistics table for AncLDH*, AncMDH2, AncMDH2-INS, and <italic>Pf</italic>LDH-W107fA structures.",
            ),
            ("label", "Figure 7—figure supplement 1."),
            ("full_label", "Figure 7—figure supplement 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 22),
            ("parent_sibling_ordinal", 7),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.030"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 30),
            ("ordinal", 23),
            ("sibling_ordinal", 2),
            ("asset", "figsupp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.031"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.031"),
            ("id", "fig8"),
            ("title", "Alternative LDH mutations in AncMDH2."),
            ("full_title", "Alternative LDH mutations in AncMDH2."),
            ("label", "Figure 8."),
            ("full_label", "Figure 8."),
            (
                "caption",
                "Relative specificity (RS) is described in legend of Figure 4.",
            ),
            (
                "full_caption",
                'Relative specificity (RS) is described in legend of <xref ref-type="fig" rid="fig4">Figure 4</xref>.',
            ),
            (
                "content",
                "Relative specificity (RS) is described in legend of Figure 4. DOI: http://dx.doi.org/10.7554/eLife.02304.031 10.7554/eLife.02304.032Figure 8—source data 1.Kinetic parameters for specificity residue mutants.DOI: http://dx.doi.org/10.7554/eLife.02304.032 DOI: http://dx.doi.org/10.7554/eLife.02304.032",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "fig"),
            ("position", 31),
            ("ordinal", 24),
            ("sibling_ordinal", 8),
            ("asset", None),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.032"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.032"),
            ("id", "SD6-data"),
            ("title", "Kinetic parameters for specificity residue mutants."),
            ("full_title", "Kinetic parameters for specificity residue mutants."),
            ("label", "Figure 8—source data 1."),
            ("full_label", "Figure 8—source data 1."),
            ("parent_type", "fig"),
            ("parent_ordinal", 24),
            ("parent_sibling_ordinal", 8),
            ("parent_asset", None),
            ("content", "DOI: http://dx.doi.org/10.7554/eLife.02304.032"),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 32),
            ("ordinal", 6),
            ("sibling_ordinal", 1),
            ("asset", "data"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.033"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.033"),
            ("id", "SD7-data"),
            ("label", "Supplementary file 1."),
            ("full_label", "Supplementary file 1."),
            (
                "caption",
                "Sequences, alignments, and trees. Alignments and tree files for both the original (Figure 3) and the alternative phylogeny. Alignment for Figure 5—figure supplement 1. Ancestral FASTA files and posterior probabilities for each ancestral sequence (parsed in Figure 6—figure supplements 1–6).",
            ),
            (
                "full_caption",
                '<bold>Sequences, alignments, and trees</bold>. Alignments and tree files for both the original (<xref ref-type="fig" rid="fig3">Figure 3</xref>) and the alternative phylogeny. Alignment for <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. Ancestral FASTA files and posterior probabilities for each ancestral sequence (parsed in <xref ref-type="fig" rid="fig6s1 fig6s2 fig6s3 fig6s4 fig6s5 fig6s6">Figure 6—figure supplements 1–6</xref>).',
            ),
            (
                "content",
                "Sequences, alignments, and trees. Alignments and tree files for both the original (Figure 3) and the alternative phylogeny. Alignment for Figure 5—figure supplement 1. Ancestral FASTA files and posterior probabilities for each ancestral sequence (parsed in Figure 6—figure supplements 1–6). DOI: http://dx.doi.org/10.7554/eLife.02304.033",
            ),
            ("mimetype", "application"),
            ("mime-subtype", "zip"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 33),
            ("ordinal", 7),
            ("sibling_ordinal", 1),
            ("asset", "supp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.034"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.034"),
            ("id", "SD8-data"),
            ("label", "Supplementary file 2."),
            ("full_label", "Supplementary file 2."),
            (
                "caption",
                "Molecular weights and extinction coefficients. ExPASy calculated molecular weights and extinction coefficients for all proteins used within this study.",
            ),
            (
                "full_caption",
                "<bold>Molecular weights and extinction coefficients</bold>. ExPASy calculated molecular weights and extinction coefficients for all proteins used within this study.",
            ),
            (
                "content",
                "Molecular weights and extinction coefficients. ExPASy calculated molecular weights and extinction coefficients for all proteins used within this study. DOI: http://dx.doi.org/10.7554/eLife.02304.034",
            ),
            ("mimetype", "application"),
            ("mime-subtype", "pdf"),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "supplementary-material"),
            ("position", 34),
            ("ordinal", 8),
            ("sibling_ordinal", 2),
            ("asset", "supp"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.035"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.035"),
            ("id", "SA1"),
            ("title", "Decision letter"),
            ("full_title", "Decision letter"),
            (
                "contributors",
                [
                    {
                        "type": "editor",
                        "role": "Reviewing editor",
                        "surname": "Levitt",
                        "given-names": "Michael",
                        "affiliations": [
                            {
                                "institution": "Stanford University",
                                "country": "United States",
                            }
                        ],
                    }
                ],
            ),
            (
                "content",
                "eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see review process). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers. Thank you for sending your work entitled “An atomic-resolution view of neofunctionalization in the evolution of apicomplexan lactate dehydrogenases” for consideration at eLife. Your article has been favorably evaluated by a Senior editor, a Reviewing editor, and 2 reviewers. The Reviewing editor and the reviewers discussed their comments before we reached this decision. If you have any questions about prioritizing changes in response to these comments, please do not hesitate to contact us for advice. Please examine these comments with great care. They come from two preeminent experts and both reviewers will need to be satisfied with your revised manuscript. Reviewer #1: Boucher et al explore the genesis and evolution of apicomplexan lactate dehydrogenase (LDH) by gene duplication of a malate dehydrogenase (MDH) followed by a shift in substrate specificity. They combine phylogeny, sequence analysis and ancestral reconstruction with protein crystallography and enzymatic assays to determine sequences underlying substrate specificity and possible evolutionary paths for the shift in function. This multi-functional approach provides new insights into the shift of enzyme function in this case, and may be relevant to the evolution of other enzymes. The omission of the underlying data for the sequence analysis – protein sequences, alignments, trees, and ancestral sequences – severely detract from the paper, both as an overall advance in understanding of this enzyme evolution and for the general method, as well as for my ability to review it. I strongly urge that these data be provided in a useful manner (i.e. machine-readable text files, not pdfs). The paper is well written from an English language and grammatical point of view, but I found the flow of the arguments to be difficult to follow, frequently overstated, and not always cohesive. MDH/LDH Phylogeny Analysis: The breadth of the phylogenetic analysis is not clear. The use of several starting proteins for Blast analysis, and a tight cutoff rather than psi-blast or HMMs, cast some doubt on how comprehensive the survey of MDH/LDH homologs is. The phylogenetic analysis would greatly benefit from an explicit discussion of the species distributions. Are the mitochondrial and cytosolic MDHs unique to and universal across free-living eukaryotes? Where do bacterial and archaeal MDHs fall? Are the LDHs also found in all free-living eukaryotes? Why was LDH re-invented in apicomplexans and Trichomonas - do they also have a canonical LDH, or as obligate parasites, did their ancestors lose it? Can glycolysis still proceed and lactate be excreted in the absence of LDH? The answers to these questions are important in providing an evolutionary and functional context for the evolution of these new LDH genes and the possible functionality of ancestral enzymes of relaxed specificity. The text states that “α/β- glucosidases and aspartate dehydrogenases as outgroups”, but only a single α-glucosidase is shown in the figure. According to SCOP, the MDH/LDH and α/β- glucosidases share a superfamily, but the aspDH are in a separate superfamily. These discrepancies should be resolved. The only support for the hypothesis that LDHs derived from “LDH-like MDHs” is the statement in the figure legend that this branch has an aLRT support of 42. Please explain this measurement and why it supports the claim of 4 inventions of LDH from MDH, and document the use of the aLRT in the Methods. Certainly these LDHs cannot be said to be “deep within MDH clades”, unlike the other cases. Likewise, the claim that the rooting of the tree divides it into two major clades is not quantitatively supported. Sequence Analysis and Ancestral Sequence Reconstruction: The authors oversimplify the initial comparison of apicomplexan LDH and MDH proteins, focusing on the 5-AA insert (confusingly referred to as a “6-residue loop insertion”), resulting in an awkward backtrack in later sections, where they are forced to consider additional changes between sequences. A more complete analysis of the substantial changes between Apicomplexan MDH and LDH proteins at the beginning would be far more helpful, informative, and clear. This should include mention of position 103, which is within the loop region and is substantially different in LDH (small hydrophobic) from MDH (basic). It is not surprising that an alanine scan would have little effect on this position; a mutation to the 'ancestral' lysine would be more informative. Since it is adjacent to K102 and of the same charge, it is more likely than not that this change influences either substrate specificity or enzyme activity. The claim that Trp107f is the “modern apicomplexan specificity residue” is a bit overblown. It is the most important single residue to determine specificity and activity within the context of the insertion and other aspects of apicomplexan LDH, but it is unhelpful to strongly analogize with the traditional specificity residue at #102. Its molecular mechanism is not described and the uniqueness of its importance is also not resolved. Supplemental Figure 4B lacks any legend and I find it difficult to interpret. The epistatic interactions seem to be over-interpreted. For instance, there is a discussion section headed “Convergent evolution of apicomplexan LDH involved long-range epistasis” but this is only inferred from the lack of obvious short-range epistasis, and no mechanistic model is presented for what this epistasis might be. Similarly, the conclusion that epistatic interactions are common simply because residue 102 mutations do not always result in strong substrate switching is not warranted; for epistasis to be shown, an interaction between two mutations must be directly shown. The claims that: “there are no clear examples of classic neofunctionalization or gain-of-function mutations” and “the apicomplexan enzymes provide the first clear example of neofunctionalization in protein evolution” is unsupported. Cited previous examples include RNaseA, an antifreeze protein in Antarctic zoarcid fish (PMID: 21115821), and retinoic acid receptors (PMID: 16839186). It could also be argued that since the MDH/LDH system simply involves changing substrate specificity, that the change is not particularly 'neo' but rather a tuning of an existing function. Reviewer #2: In this interesting manuscript, the authors describe a well-supported case of neofunctionalization after gene duplication. The authors chose a unique enzyme that is a malaria drug target and convincingly demonstrate that it gained a new function after originating by gene duplication of an enzyme horizontally transferred from bacteria. Interestingly, this new function is not only essential for these protist parasites, but also has an analogous (independently evolved, convergent) counterpart in other organisms. I think this might become a textbook example of neofunctionalization, because it is so thoroughly supported by ample evidence, from computation to biochemistry and crystallography. As such, I think it would make the paper more attractive, if some of the material is summarized better. E.g., a summary “graphical abstract” figure that shows the logic of the project, and tells the whole story at a glance might be great to have. Currently, the key important points drown in the minutiae of rationalizations and experimental details. Not that the manuscript is poorly written. I think it is very good, and the subsection title lines are particularly well-crafted. However, some further thinking might be in order to increase the impact of the paper and make it more accessible to a wider audience. Also, it would be great to articulate and summarize explicitly the mechanisms that confer specificity in 3 enzymes: MDH and two convergent LDHs. E.g., “characterized by long-range epistasis, a promiscuous intermediate, and relatively few gain-of-function mutations of large effect” is an excellent summary, but it does not help much in terms of mechanistic understanding. I would love to see (not necessarily in the Abstract) equally crisp mechanistic summary. The beauty of this work is in gaining so many insights into the mechanism, and I think it should be highlighted better. On a technical side, I am impressed with the crystallography and the role of structures in the project. It should be noted, however, that ancestral reconstruction from highly divergent present-day sequences is a very difficult problem and is prone to many types of errors. The authors should be commended on exploring alternative reconstructions. Also, along the lines that final results justify the means, the authors show that “resurrected” proteins are very specific to their expected substrates. However, I would like to see more discussion and thought devoted to uncertainty with reconstruction, and zooming in the regions and substitutions that confer specificity. I am not suggesting any additional experiments – what the authors did looks sufficient – but simply giving a reader better appreciation that ancestral reconstruction is always highly hypothetical and is never truly reliable might be useful. Is it at all conceivable that the ancestral enzyme had broader specificity, but reconstruction methods were overwhelmed by the number of bacterial MDHs or what not? Nature is there to fool you.",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "sub-article"),
            ("position", 35),
            ("ordinal", 1),
            ("sibling_ordinal", 1),
            ("asset", "dec"),
        ]
    ),
    OrderedDict(
        [
            ("doi", "10.7554/eLife.02304.036"),
            ("doi_url", "https://doi.org/10.7554/eLife.02304.036"),
            ("id", "SA2"),
            ("title", "Author response"),
            ("full_title", "Author response"),
            (
                "content",
                "Reviewer #1: Boucher et al explore the genesis and evolution of apicomplexan lactate dehydrogenase (LDH) by gene duplication of a malate dehydrogenase (MDH) followed by a shift in substrate specificity. They combine phylogeny, sequence analysis and ancestral reconstruction with protein crystallography and enzymatic assays to determine sequences underlying substrate specificity and possible evolutionary paths for the shift in function. This multi-functional approach provides new insights into the shift of enzyme function in this case, and may be relevant to the evolution of other enzymes. The omission of the underlying data for the sequence analysis -protein sequences, alignments, trees, and ancestral sequences – severely detract from the paper, both as an overall advance in understanding of this enzyme evolution and for the general method, as well as for my ability to review it. I strongly urge that these data be provided in a useful manner (i.e. machine-readable text files, not pdfs). We agree, apologize for the oversight, and now provide this important additional data and information, including all sequences, alignments, and trees in plain text. MDH/LDH Phylogeny Analysis: The breadth of the phylogenetic analysis is not clear. The use of several starting proteins for Blast analysis, and a tight cutoff rather than psi-blast or HMMs, cast some doubt on how comprehensive the survey of MDH/LDH homologs is. We want to emphasize that the purpose of our paper is not to provide a comprehensive phylogenetic analysis of all MDH/LDH homologs, as this has been done previously by others (Madern 2002, 2004; Golding and Dean 1998; Zhou and Keithly 2002). Our analysis, though much broader than these studies, largely supports the major conclusions from the earlier work. Rather, we focus on the Apicomplexan homologs, esp. the convergent LDHs, which have received less phylogenetic attention. The phylogenetic analysis would greatly benefit from an explicit discussion of the species distributions. Are the mitochondrial and cytosolic MDHs unique to and universal across free-living eukaryotes? Where do bacterial and archaeal MDHs fall? Are the LDHs also found in all free-living eukaryotes? Why was LDH re-invented in apicomplexans and Trichomonas – do they also have a canonical LDH, or as obligate parasites, did their ancestors lose it? Can glycolysis still proceed and lactate be excreted in the absence of LDH? The answers to these questions are important in providing an evolutionary and functional context for the evolution of these new LDH genes and the possible functionality of ancestral enzymes of relaxed specificity. We have now added a few sentences addressing each of these questions in the main text (“Results: LDH enzymes have evolved independently at least four times”), including a new supplemental figure highlighting the bacterial, eukaryotic, and archaeal distribution on the global tree (Figure 3–figure supplement 2). The text states that “α/β- glucosidases and aspartate dehydrogenases as outgroups”, but only a single α-glucosidase is shown in the figure. According to SCOP, the MDH/LDH and α/β- glucosidases share a superfamily, but the aspDH are in a separate superfamily. These discrepancies should be resolved. As explained in the Methods, the closest Rossmann folds were used to root the tree, as determined from a profile-based phylogenetic analysis. Apparently, only the Rossmann fold domains of the MDH/LDHs and the aspDHs are homologous. The only support for the hypothesis that LDHs derived from “LDH-like MDHs” is the statement in the figure legend that this branch has an aLRT support of 42. Please explain this measurement and why it supports the claim of 4 inventions of LDH from MDH, and document the use of the aLRT in the Methods. Certainly these LDHs cannot be said to be “deep within MDH clades”, unlike the other cases. Likewise, the claim that the rooting of the tree divides it into two major clades is not quantitatively supported. We have expanded the section on the rooting, and we now also explain the aLRT branch support statistic (developed by Olivier Gascuel and colleagues, and implemented in PhyML), and show the supports on the tree in Figure 3 – figure supplement 1. Briefly, the aLRT is an approximate log-likelihood ratio statistic, where raw values > 8 are roughly “statistically significant”, representing an e^8=3000-fold better fit of the tree to the data when the clade is present (in terms of the likelihood). The aLRT can also be used in a traditional significance test to provide a confidence level (between 0 and 1, similar to a probability) for a clade. While the exact ML position of the root is poorly supported, there is very high support for a root position within the MDH portion of the tree, somewhere near the center. Sequence Analysis and Ancestral Sequence Reconstruction: The authors oversimplify the initial comparison of apicomplexan LDH and MDH proteins, focusing on the 5-AA insert (confusingly referred to as a “6-residue loop insertion”), resulting in an awkward backtrack in later sections, where they are forced to consider additional changes between sequences. A more complete analysis of the substantial changes between Apicomplexan MDH and LDH proteins at the beginning would be far more helpful, informative, and clear. We have expanded the description of the differences between the modern MDH and LDH proteins. This should include mention of position 103, which is within the loop region and is substantially different in LDH (small hydrophobic) from MDH (basic). It is not surprising that an alanine scan would have little effect on this position; a mutation to the 'ancestral' lysine would be more informative. Since it is adjacent to K102 and of the same charge, it is more likely than not that this change influences either substrate specificity or enzyme activity. We originally thought that the 103 position was unlikely to be responsible for differences in activity/specificity between the apicomplexan MDH and LDHs. Our reasoning was based on the following structural evidence. In the crystal structures, the MDH Lys103 points in the opposite direction of Arg102, away from the active site, not contacting the substrate; (the positively charged nitrogens in the two sidechains are over 11 angstroms distant). Similarly, the beta carbon of the LDH 103 residue (Ala,Val,Leu, or Ile) points away from the active site into solution, in the opposite direction of Lys102, at the tip of the insertion in the loop, relatively far from active site and substrate. Nevertheless, data always trumps words, so at the reviewer’s suggestion we made the A103K mutation in both the modern PfLDH and in the ancestor. Both mutants are kinetically indistinguishable from WT for both pyruvate and oxaloacetate, confirming our original inclination. The claim that Trp107f is the “modern apicomplexan specificity residue” is a bit overblown. It is the most important single residue to determine specificity and activity within the context of the insertion and other aspects of apicomplexan LDH, but it is unhelpful to strongly analogize with the traditional specificity residue at #102. Its molecular mechanism is not described and the uniqueness of its importance is also not resolved. As the reviewer agrees, our data indicates that Trp107f residue is “the most important single residue to determine specificity and activity within the context of the insertion and other aspects of the apicomplexan LDH” – hence our assertion that Trp107f is the apicomplexan “specificity residue” (a convenient yet simplistic label). Clearly Trp107f is not the only residue important for specificity – a major point of our paper – but the same is true of the “traditional” specificity residue at position 102, which is at best necessary but insufficient for determining substrate specificity. The molecular mechanism by which apicomplexan Trp107f contributes to pyruvate recognition likely involves the hydrophobic Trp sidechain interacting with the hydrophobic pyruvate methyl and the bulky Trp sidechain sterically occluding the methylene carboxylate of oxaloacetate. We have now added a sentence to this effect in the text. Supplemental Figure 4B lacks any legend and I find it difficult to interpret. We now provide a legend for Figure 4B. The main point is that the W107fA mutant is highly similar to the WT, except for the active site loop which is partially disordered and in the open conformation. The epistatic interactions seem to be over-interpreted. For instance, there is a discussion section headed “Convergent evolution of apicomplexan LDH involved long-range epistasis”but this is only inferred from the lack of obvious short-range epistasis, and no mechanistic model is presented for what this epistasis might be. Our conclusion of long-range epistasis is not based on negative evidence. Rather, epistasis is defined as a mutation having different effects depending on the identity of residues at other sites. Our data provide clear evidence of this; both the R102K mutation and the loop insertion have differing kinetic effects when introduced in the modern vs ancestral proteins. The residues that comprise the active sites of the modern and ancestral proteins are identical; the residue differences are found only at sites removed from the active site. Hence, the epistasis we observe is necessarily long-range. Elucidating the precise mechanism of this long-range epistasis will not be trivial, but it is currently one of our major ongoing projects. We suspect that the mechanism will come down to shifting energy landscapes (a type of protein dynamics). Similarly, the conclusion that epistatic interactions are common simply because residue 102 mutations do not always result in strong substrate switching is not warranted; for epistasis to be shown, an interaction between two mutations must be directly shown. Residue 102 mutations frequently result in different levels of substrate specificity, depending on which protein they are made in. This is direct, prima facie evidence of epistasis, by definition. Epistatic interactions are not restricted to two sites, but can exist between different sets of sites. The claims that: “there are no clear examples of classic neofunctionalization or gain-of-function mutations” and “the apicomplexan enzymes provide the first clear example of neofunctionalization in protein evolution” is unsupported. Cited previous examples include RNaseA, an antifreeze protein in Antarctic zoarcid fish (PMID: 21115821), and retinoic acid receptors (PMID: 16839186). It could also be argued that since the MDH/LDH system simply involves changing substrate specificity, that the change is not particularly 'neo' but rather a tuning of an existing function. We agree with the reviewer that there are other potential examples of neo-functionalization, and that what counts as a new function is largely a matter of degree. We have therefore changed “the first clear example” to “a clear example”. Reviewer #2: In this interesting manuscript, the authors describe a well-supported case of neofunctionalization after gene duplication. The authors chose a unique enzyme that is a malaria drug target and convincingly demonstrate that it gained a new function after originating by gene duplication of an enzyme horizontally transferred from bacteria. Interestingly, this new function is not only essential for these protist parasites, but also has an analogous (independently evolved, convergent) counterpart in other organisms. I think this might become a textbook example of neofunctionalization, because it is so thoroughly supported by ample evidence, from computation to biochemistry and crystallography. As such, I think it would make the paper more attractive, if some of the material is summarized better. E.g. a summary “graphical abstract” figure that shows the logic of the project, and tells the whole story at a glance might be great to have. Currently, the key important points drown in the minutiae of rationalizations and experimental details. Not that the manuscript is poorly written. I think it is very good, and the subsection title lines are particularly well-crafted. However, some further thinking might be in order to increase the impact of the paper and make it more accessible to a wider audience. We have made a new graphic that succinctly summarizes the mutation experiments. We hope that Figure 5 already provides a good graphical summary of the phylogenetic and activity data. Also, it would be great to articulate and summarize explicitly the mechanisms that confer specificity in 3 enzymes: MDH and two convergent LDHs. E.g., “characterized by long-range epistasis, a promiscuous intermediate, and relatively few gain-of-function mutations of large effect” is an excellent summary, but it does not help much in terms of mechanistic understanding. I would love to see (not necessarily in the Abstract) equally crisp mechanistic summary. The beauty of this work is in gaining so many insights into the mechanism, and I think it should be highlighted better. We have now added a couple sentences regarding the mechanism to the Abstract, and we have also added a new section in the Discussion that goes into this in detail (“An alternate mechanism of specificity in the convergent apicomplexan LDH”). On a technical side, I am impressed with the crystallography and the role of structures in the project. It should be noted, however, that ancestral reconstruction from highly divergent present-day sequences is a very difficult problem and is prone to many types of errors. The authors should be commended on exploring alternative reconstructions. Also, along the lines that final results justify the means, the authors show that “resurrected” proteins are very specific to their expected substrates. However, I would like to see more discussion and thought devoted to uncertainty with reconstruction, and zooming in the regions and substitutions that confer specificity. I am not suggesting any additional experiments – what the authors did looks sufficient – but simply giving a reader better appreciation that ancestral reconstruction is always highly hypothetical and is never truly reliable might be useful. Is it at all conceivable that the ancestral enzyme had broader specificity, but reconstruction methods were overwhelmed by the number of bacterial MDHs or what not? Nature is there to fool you. We have expanded the section on the alternate reconstructions.",
            ),
            ("article_doi", "10.7554/eLife.02304"),
            ("type", "sub-article"),
            ("position", 36),
            ("ordinal", 2),
            ("sibling_ordinal", 2),
            ("asset", "resp"),
        ]
    ),
]
